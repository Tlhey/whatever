<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2025-05-20-EDM | Tlhey</title><meta name="author" content="Tlhey"><meta name="copyright" content="Tlhey"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Instruction 模拟退火 smld: https://zhuanlan.zhihu.com/p/709301288https://zhuanlan.zhihu.com/p/797467112 sde 统一:..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2025-05-20-EDM",
  "url": "https://tlhey.github.io/whatever/2025/05/20/2025-05-20-EDM/",
  "image": "https://tlhey.github.io/whatever/whatever/img/Lain/Lain_024.jpeg",
  "datePublished": "2025-05-20T19:04:21.000Z",
  "dateModified": "2025-05-26T00:45:28.358Z",
  "author": [
    {
      "@type": "Person",
      "name": "Tlhey",
      "url": "https://tlhey.github.io/whatever/"
    }
  ]
}</script><link rel="shortcut icon" href="/whatever/img/favicon.png"><link rel="canonical" href="https://tlhey.github.io/whatever/2025/05/20/2025-05-20-EDM/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/whatever/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/whatever/img/Pink.jpeg"/><link rel="icon" type="image/png" sizes="32x32" href="/whatever/img/Pink.jpeg"/><link rel="icon" type="image/png" sizes="16x16" href="/whatever/img/Pink.jpeg"/><link rel="mask-icon" href="/whatever/img/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/whatever/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/whatever/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2025-05-20-EDM',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'post'
}</script><link rel="stylesheet" href="/whatever/css/modify.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/whatever/img/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/whatever/img/Pink.jpeg" onerror="this.onerror=null;this.src='/whatever/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/whatever/archives/"><div class="headline">Articles</div><div class="length-num">55</div></a><a href="/whatever/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/whatever/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whatever/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/whatever/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/whatever/img/Lain/Lain_024.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/whatever/"><img class="site-icon" src="/whatever/img/Pink.jpeg" alt="Logo"><span class="site-name">Tlhey</span></a><a class="nav-page-title" href="/whatever/"><span class="site-name">2025-05-20-EDM</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whatever/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/whatever/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">2025-05-20-EDM</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-20T19:04:21.000Z" title="Created 2025-05-20 12:04:21">2025-05-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-26T00:45:28.358Z" title="Updated 2025-05-25 17:45:28">2025-05-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Instruction</p>
<p>模拟退火 smld: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/709301288">https://zhuanlan.zhihu.com/p/709301288</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/797467112">https://zhuanlan.zhihu.com/p/797467112</a></p>
<p>sde 统一: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/709369588">https://zhuanlan.zhihu.com/p/709369588</a><br>ddpm: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/699359877">https://zhuanlan.zhihu.com/p/699359877</a><br>edm论文导读: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/708565985">https://zhuanlan.zhihu.com/p/708565985</a><br>edm dw 图: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/720944836">https://zhuanlan.zhihu.com/p/720944836</a></p>
<p>Project Overview</p>
<ul>
<li>motivation</li>
<li>problem definition (key: improvisation, multi track)</li>
</ul>
<p>Techs used </p>
<ul>
<li>edm perspective (my understanding breifly)<ul>
<li>VP: DDPM</li>
<li>VE: SMLD</li>
</ul>
</li>
<li>consistency distillation (may distinct from others)</li>
</ul>
<p>Related works: (how others do)</p>
<ul>
<li>AudioLDM&#x2F;MusicLDM</li>
<li>…</li>
</ul>
<p>Method</p>
<ul>
<li>Base model:  mt-musicldm model structure</li>
</ul>
<p>What I have done and plan to </p>
<p>Here is the completed and structured version of the given text:</p>
<hr>
<p><strong>Motivation:</strong></p>
<p>In the task of the Real-Time Instrumental Improvisation Project (RTIIP), fast generation speed is crucial since the goal is to enable a live musical system that can improvise alongside a human musician. Most existing methods based on DDPM (Denoising Diffusion Probabilistic Models), which typically involve 1000 steps, or DDIM (Denoising Diffusion Implicit Models), which involve around 200 steps, are not fast enough for real-time performance.</p>
<p>In contrast, <strong>Consistency Models (CM)</strong> are advantageous because they significantly reduce the number of denoising steps required for generation, making them well-suited for real-time applications. By applying <strong>Consistency Distillation (CD)</strong> to diffusion models, it is possible to achieve fast generation while maintaining quality, as CD can reduce the process to 1-2 steps without a significant loss in audio quality. Therefore, integrating CM techniques with Multi-Track MusicLDM can substantially enhance speed and efficiency, making real-time improvisation feasible.</p>
<hr>
<p><strong>Definition:</strong></p>
<p><strong>Multi-Track MusicLDM (MT-MusicLDM)</strong> is a diffusion-based model designed for multi-track audio generation and inpainting.</p>
<ul>
<li><p><strong>Given Input:</strong></p>
<ul>
<li>Length: 10 seconds (processed in 2.5-second chunks)</li>
<li>Dimension: Mel-spectrogram (compressed latent representation)</li>
<li>Channels: 4 (e.g., drums, bass, melody, harmony)</li>
<li>Dataset Size: Not explicitly stated, typically large-scale multi-track music datasets</li>
</ul>
</li>
<li><p><strong>Expected Output:</strong></p>
<ul>
<li>Generated audio track(s) that seamlessly continue or complete the given input audio, preserving musical coherence.</li>
</ul>
</li>
<li><p><strong>Content:</strong></p>
<ul>
<li>Multi-track instrumental improvisation and inpainting in a live performance setting.</li>
</ul>
</li>
<li><p><strong>Speed Requirement:</strong></p>
<ul>
<li>Current speed: Generates 2.5 seconds of audio in approximately 2.5 seconds (1x real-time).</li>
<li>Target speed: Significantly faster, ideally with only 1-2 denoising steps through consistency distillation.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>General Model Structure:</strong></p>
<p>The model is built on <strong>MT-MusicLDM</strong>, but the focus is on improving generation speed and quality through the integration of <strong>Consistency Distillation (CD)</strong>. The key components include:</p>
<ol>
<li><p><strong>Input Processing:</strong> Receiving multi-channel audio input from MAX&#x2F;MSP via OSC messages.</p>
</li>
<li><p><strong>Mel-Spectrogram Conversion:</strong> Compressing audio into latent space representations.</p>
</li>
<li><p><strong>Diffusion Process:</strong></p>
<ul>
<li>Standard MT-MusicLDM requires ~200 steps.</li>
<li>CD aims to reduce steps to 1-2.</li>
</ul>
</li>
<li><p><strong>Output Synthesis:</strong> Converting latent representation back to Mel-spectrogram and finally to audio waveform.</p>
</li>
<li><p><strong>Real-Time Optimization:</strong> Reducing latency and edge artifacts (e.g., phase discontinuities) by integrating overlapping segments and minimizing denoising steps.</p>
</li>
</ol>
<hr>
<p>2.1 Original DDPM and SMLD formula</p>
<p>DDPM<br>train<br>	forward<br>		$q(x_t \mid x_{t-1}) &#x3D; \mathcal{N}(x_t \mid \sqrt{1 - \beta_t} \cdot x_{t-1}, \beta_t \cdot I)$<br>		$q(x_t \mid x_0) &#x3D; \mathcal{N}(x_t \mid \sqrt{\bar{\alpha}<em>t} \cdot x_0, (1 - \bar{\alpha}<em>t) \cdot I)$  where $\bar{\alpha}<em>t &#x3D; \prod</em>{s&#x3D;1}^{t} (1 - \beta_s)$<br>	reverse<br>		$p</em>\theta(x</em>{t-1} \mid x_t) &#x3D; \mathcal{N}(x_{t-1} \mid \mu_\theta(x_t, t), \sigma_t^2 \cdot I)$<br>	loss<br>		$L(\theta) &#x3D; \mathbb{E}<em>{x_0, \epsilon, t} \left[ \lVert \epsilon - \epsilon</em>\theta(x_t, t) \rVert^2 \right]$</p>
<p>inference: iteratively<br>	$x_{t-1} &#x3D; \frac{1}{\sqrt{\alpha_t}} \left( x_t - \frac{\beta_t}{\sqrt{1 - \bar{\alpha}<em>t}} \epsilon</em>\theta(x_t, t) \right) + \sigma_t \cdot z$</p>
<p>SMLD with langevan, and Generative Modeling by Estimating Gradients of the Data Distribution<br>score function $s_{\theta}(x)&#x3D;\nabla_x{\text{log }p(x)}$, (sliced, denosing)<br>Noise Conditional Score-Based Model, (also called a Noise Conditional Score Network, or NCSN</p>
<p>SMLD<br>score$\nabla_x{\text{log }p(x)}$<br>train $s_{\theta}(x)$ which enforcing $s_θ(x);\approx;\nabla_x\log p(x)$<br>	(sliced) normal score matching $J_{\mathrm{SM}}(\theta)&#x3D;\mathbb{E}<em>{x\sim p(x)}|\nabla_x\log p(x)-s</em>\theta(x)|<em>2^2$<br>	or denoising score matching $J</em>{\mathrm{DSM}}(\theta)&#x3D;\sum_{i&#x3D;1}^L\lambda(i),\mathbb{E}<em>{x\sim p</em>{\sigma_i}(x)}|\nabla_x\log p_{\sigma_i}(x)-s_\theta(x,i)|_2^2$</p>
<p>sample: Langevin Dynamics<br>	$x_{i+1}&#x3D;x_i+\epsilon \nabla_x\log p(x_i)+\sqrt{2,\epsilon};z_i,\quad z_i\sim \mathbb{N}(0,I)$</p>
<p>2.2 SDE 统一<br>$\mathrm{d}x_\pm &#x3D; -\dot{\sigma}(t)\sigma(t)\nabla_x \log p(x;\sigma(t)) , \mathrm{d}t ;; \pm ;; \beta(t)\sigma(t)^2 \nabla_x \log p(x;\sigma(t)) , \mathrm{d}t ;; + ;; \sqrt{2\beta(t)}\sigma(t) , \mathrm{d}\omega_t$</p>
<p>train:<br>	sde:<br>		$\mathrm{d}\mathbf{x} &#x3D; \mathbf{f}(\mathbf{x}, t),\mathrm{d}t + g(t),\mathrm{d}\mathbf{w}$<br>	loss function: to train $s_θ(x);\approx;\nabla_x\log p(x)$<br>		$\theta^* &#x3D; \arg\min_\theta \mathbb{E}<em>t \left{ \lambda(t) , \mathbb{E}</em>{\mathbf{x}(0)} , \mathbb{E}<em>{\mathbf{x}(t) \mid \mathbf{x}(0)} \left[ \left| \mathbf{s}</em>\theta(\mathbf{x}(t), t) - \nabla_{\mathbf{x}(t)} \log p_{0t}(\mathbf{x}(t) \mid \mathbf{x}(0)) \right|<em>2^2 \right] \right}$<br>inference: known $f(x,t)$ and $g(t)$, do integration from $t&#x3D;T$ to $t&#x3D;0$<br>	$\mathrm{d}\mathbf{x} &#x3D; \left[\mathbf{f}(\mathbf{x}, t) - g(t)^2 \nabla</em>{\mathbf{x}} \log p_t(\mathbf{x})\right] \mathrm{d}t + g(t),\mathrm{d}\bar{\mathbf{w}}$</p>
<p>2.3 VP, VE DDPM SMLD<br>DDPM<br>$x_i &#x3D; \sqrt{1 - \beta_i},x_{i-1} + \sqrt{\beta_i},z_{i-1}, \quad z_{i-1} \sim \mathcal{N}(0, I)$<br>$\mathrm{d}x &#x3D; \underbrace{0}<em>{f(x,t)},\mathrm{d}t + \underbrace{\sqrt{\frac{\mathrm{d}}{\mathrm{d}t}[\sigma(t)^2]}}</em>{g(t)},\mathrm{d}w$</p>
<p>2.4 sde -&gt;pfode<br>SDE:<br>	$\mathrm{d}\mathbf{x} &#x3D; \left[\mathbf{f}(\mathbf{x}, t) - g(t)^2 \nabla_{\mathbf{x}} \log p_t(\mathbf{x})\right] \mathrm{d}t + g(t),\mathrm{d}\bar{\mathbf{w}}$<br>(Corresponding) PF-ODE<br>	$\mathrm{d}\mathbf{x} &#x3D; \left[\mathbf{f}(\mathbf{x}, t) - g(t)^2 \nabla_{\mathbf{x}} \log p_t(\mathbf{x})\right] \mathrm{d}t$  </p>
<p>scale schedule $s(t)$<br>noise schedule $\sigma(t)$</p>
<p> EDM </p>
<p> SDE (2022)<br>	 forward SDE<br>		 $d x &#x3D; f(x, t),d t + g(t),d \omega_{t}$<br>	 corresponding PF-ODE<br>		 $d x &#x3D; \bigl[f(t),x ;-;\tfrac{1}{2},g(t)^{2},\nabla_{x}\log p_{t}(x)\bigr],d t$<br>EDM (2023)<br>	forward SDE<br>		$d x &#x3D; -,\dot{\sigma}(t),\sigma(t),\nabla_{x}\log p\bigl(x;,\sigma(t)\bigr),d t$<br>	corresponding PF-ODE<br>		$d x &#x3D; \Bigl[\tfrac{\dot{s}(t)}{s(t)},x ;-;s(t)^{2},\dot{\sigma}(t),\sigma(t),\nabla_{x}\log p,\bigl(\tfrac{x}{s(t)};,\sigma(t)\bigr)\Bigr],d t$</p>
<p>SDE (2022)<br>	$f(x, t)$: drift function in the SDE<br>	$g(t)$: diffusion coefficient in the SDE<br>EDM (2023)<br>	$\sigma(t)$: noise schedule, indicating how noisy the data is at time $t$.<br>	$s(t)$: scaling schedule, applied to $x$.<br>	<br>	<br>	(used in time-dependent signal scaling).</p>
<p>$x$: the data sample or point in space (e.g., an image).<br>$t$: continuous time variable, usually running from 0 (clean) to 1 (very noisy).<br>$f(x, t)$: drift function in the SDE, governing the deterministic part of change.<br>$g(t)$: diffusion coefficient in the SDE, controlling how much random noise is added.<br>$d\omega_{t}$: infinitesimal Wiener process (Brownian motion) term—pure noise.<br>$p_{t}(x)$: probability density of $x$ at time $t$ under the forward SDE.<br>$\nabla_{x}\log p_{t}(x)$: the score, i.e. the gradient of the log-density wrt $x$.<br>$\sigma(t)$: noise level schedule, indicating how noisy the data is at time $t$.<br>$\dot{\sigma}(t)$: time derivative of $\sigma(t)$, i.e. $d\sigma&#x2F;dt$.<br>$p(x;,\sigma(t))$: the density of $x$ given noise level $\sigma(t)$ (often same as $p_{t}(x)$).<br>$s(t)$: additional scaling function applied to $x$ (used in time-dependent signal scaling).<br>$\dot{s}(t)$: time derivative of $s(t)$, i.e. $ds&#x2F;dt$.</p>
<p><strong>E</strong>lucidating the design space of <strong>D</strong>iffusion <strong>M</strong>odel<br>simplify and clarify diffusion models by breaking them into modular design choices<br>Sampling with PF-ODE.</p>
<ol>
<li>Substitute $\mathbf f(\mathbf x, t), g(x)$ with $s(t), \sigma (t)$</li>
<li>Denoiser $D_θ(x;σ) ;&#x3D;; c_{\rm skip}(σ),\mathbf x ;+; c_{\rm out}(σ),F_θ!\bigl(c_{\rm in}(σ),\mathbf x;;c_{\rm noise}(σ)\bigr)$</li>
<li>Simple parametrization $σ_i &#x3D; \Bigl(;σ_{\max}^{1&#x2F;ρ} ;+; \tfrac{i}{N-1}\bigl(σ_{\min}^{1&#x2F;ρ}-σ_{\max}^{1&#x2F;ρ}\bigr)\Bigr)^{ρ},$</li>
</ol>
<p>Trajectory curvature<br>	The shape of ODE solution trajectory is defined by $s(t), \sigma (t)$.<br>	When $s(t)&#x3D;1, \sigma (t)&#x3D;t$, is the best choice with $d\mathbf x &#x2F;dt &#x3D; (\mathbf x-D_θ(\mathbf x;σ))&#x2F;t$</p>
<p>DDPM $\sigma(t)&#x3D;\sqrt{1-\bar\alpha_t}, ,  s(t)&#x3D;\dfrac{\dot{\bar\alpha}_t}{2,\bar\alpha_t}$</p>
<p>SMLD $\sigma(t)&#x3D;t, \ ,  s(t)&#x3D;\dfrac1t$</p>
<p>2.6  $D_\theta(x;,\sigma)$ c4</p>
<p>Similar to Denoiser in DDPM, but add more params<br>Denoiser: $D_\theta(x;,\sigma) ;&#x3D;; c_{\text{skip}}(\sigma),x ;+; c_{\text{out}}(\sigma);F_\theta\bigl(c_{\text{in}}(\sigma),x;;c_{\text{noise}}(\sigma)\bigr).$<br>$c_{\text{skip}}(\sigma),x$:   noisy imput $x$<br>$c_{\text{out}}(\sigma),F_\theta(\dots)$:  predicted clean component<br>skip connection stabilize the training and speed up convergence</p>
<p>2.7 $\sigma_i$</p>
<p>$\sigma_i$: noise level<br>pick the finite number $N$ sampling steps with $\sigma_0 \gt \sigma_1 \gt \dots \gt \sigma_{N-1}$<br>$\sigma_i ;&#x3D;;\Bigl(,\sigma_{\max}^{,1&#x2F;\rho};+;\frac{i}{N-1},\bigl(\sigma_{\min}^{,1&#x2F;\rho}-\sigma_{\max}^{,1&#x2F;\rho}\bigr)\Bigr)^{!\rho},$<br>it is a constant number for a certain model</p>
<ol start="3">
<li></li>
</ol>
<p>A <em>consistency function</em> $f(\mathbf{x}, t)$ satisfies the <em>boundary condition</em> $f(\mathbf{x}<em>\epsilon, \epsilon) &#x3D; \mathbf{x}</em>\epsilon$<br>Parametrization (smooth and differentiable)</p>
<ol>
<li>$f_\theta(\mathbf{x}, t) &#x3D;\begin{cases}\mathbf{x}, &amp; t &#x3D; \epsilon \F_\theta(\mathbf{x}, t), &amp; t \in (\epsilon, T]\end{cases}$ </li>
<li>$f_\theta(\mathbf{x}, t) &#x3D; c_{\text{skip}}(t),\mathbf{x} + c_{\text{out}}(t),F_\theta(\mathbf{x}, t)$ with $c_{\text{skip}}(\epsilon) &#x3D; 1, \quad c_{\text{out}}(\epsilon) &#x3D; 0$<br>With a well-trained cm $f_(\cdot, \cdot)$ <ol>
<li>$\hat{\mathbf{x}}_T \sim \mathcal{N}(0, T^2 \mathbf{I})$</li>
<li>$\hat{\mathbf{x}}<em>\epsilon &#x3D; f</em>\theta(\hat{\mathbf{x}}_T, T)$</li>
</ol>
</li>
</ol>
<p>2.7 cm</p>
<p>consistency function defintion:<br>$$,f:;(x_t,t);\longmapsto;x_0,\quad\text{with};;f(x_t,t)&#x3D;f(x_{t’},t’);\forall,t,t’.,$$</p>
<p>$F_\theta(\mathbf{x}, t)$</p>
<p>Follow EDM(2023) framework:<br>	PF-ODE<br>	Denoiser</p>
<p>Consistency Distillation (CD)  compare$(x_{t_{n+1}},,\hat x_{t_n}^\phi)$<br>	Loss $\mathcal{L}(\theta,\theta^-;\phi);&#x3D;;\mathbb{E}\bigl[\lambda(t_n),d\bigl(f_\theta(x_{t_{n+1}},t_{n+1}),,f_{\theta^-}(\hat x_{t_n}^\phi,,t_n)\bigr)\bigr],$<br>	where $\hat x_{t_n}^\phi &#x3D; x_{t_{n+1}} + (t_n - t_{n+1}),\Phi(x_{t_{n+1}},t_{n+1};\phi)$, $\phi$ is ODE solver<br>	Init with pre-trained diffusion model<br>	<br>Consistency Training (CT)   compare $(x+t_{n+1}z,;x+t_nz)$<br>	Loss $\mathcal{L}<em>{\rm CT}^N(\theta,\theta^-)&#x3D; \mathbb{E}\bigl[\lambda(t_n),d\bigl(f</em>\theta(x + t_{n+1}z,,t_{n+1}),,f_{\theta^-}(x + t_n z,,t_n)\bigr)\bigr],\quad z\sim\mathcal{N}(0,I).$<br>	do not need a ODE solver, updated with EMA<br>	Init randomly</p>
<p>EMA: exponential moving average</p>
<p>EDM 视角</p>
<p>DDPM (Variance-Preserving Diffusion):</p>
<p>Imagine slowly adding a little bit of Gaussian noise in many small steps so your data “fades” into pure noise.</p>
<p>forward:<br>$q(x_t \mid x_{t-1})&#x3D; \mathcal{N}\bigl(x_t; \sqrt{1 - \beta_t},x_{t-1},;\beta_t \mathbf{I}\bigr),$<br>closed form forward:<br>$q(x_t \mid x_0)&#x3D; \mathcal{N}\bigl(x_t; \sqrt{\bar\alpha_t},x_0,;(1 - \bar\alpha_t)\mathbf{I}\bigr),$<br>reverse:<br>$p_\theta(x_{t-1}\mid x_t)&#x3D; \mathcal{N}\bigl(x_{t-1};;\mu_\theta(x_t,t),;\sigma_t^2,\mathbf{I}\bigr),$<br>loss:<br>$L &#x3D; \mathbb{E}<em>{t,x_0,\epsilon}\Bigl|\epsilon - \epsilon</em>\theta\bigl(\sqrt{\bar\alpha_t},x_0 + \sqrt{1-\bar\alpha_t},\epsilon,;t\bigr)\Bigr|^2.$</p>
<p>SMLD (Score-Matching on Noisy Data, i.e. Variance-Exploding Diffusion):</p>
<p>forward sde;      $w$ is brownian motion<br>	$\mathrm{d}x &#x3D; f(x,t),\mathrm{d}t ;+; g(t),\mathrm{d}w,$<br>reverse<br>	$\mathrm{d}x &#x3D; \bigl[f(x,t) - g(t)^2,\nabla_x\ln p_t(x)\bigr],\mathrm{d}t ;+; g(t),\mathrm{d}\bar w,$<br>loss<br>	$\mathcal{L}(\theta)&#x3D;;\mathbb{E}\Bigl|,s_\theta(\tilde x,\sigma);-;\nabla_{\tilde x}\log q_\sigma(\tilde x\mid x)\Bigr|^2.$</p>
<p>DPM-Solver<br>forward sde:<br>$\mathrm{d}x &#x3D; f(x, t),\mathrm{d}t ;+; g(t),\mathrm{d}w,$<br>PF-ODE: substitute reverse SDE<br>$\mathrm{d}x &#x3D; \Bigl[f(x, t) - \tfrac12,g(t)^2,\nabla_x!\log p_t(x)\Bigr],\mathrm{d}t.$<br>Solving this ODE from $t&#x3D;1$ to $t&#x3D;0$</p>
</article><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/whatever/whatever/img/Lain/Lain_024.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/whatever/img/Pink.jpeg" onerror="this.onerror=null;this.src='/whatever/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Tlhey</div><div class="author-info-description"></div><div class="site-data"><a href="/whatever/archives/"><div class="headline">Articles</div><div class="length-num">55</div></a><a href="/whatever/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/whatever/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Tlhey"><i class="fab fa-github"></i><span>www</span></a></div><div class="sticky_layout"></div></div></main><footer id="footer" style="background-image: url(/whatever/img/Lain/Lain_024.jpeg);"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Tlhey</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/whatever/js/utils.js"></script><script src="/whatever/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>